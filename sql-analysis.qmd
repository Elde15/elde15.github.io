---
title: "Police Stop Search Rates Across Three States"
description: |
  SQL analysis comparing search rates and outcomes in California, Texas, and Florida traffic stops
author: Eli Della Bitta
date: December 1, 2025
format: 
  html:
    warning: false
    message: false
    code-fold: true
---

## Introduction

My analysis will look at traffic stop data from the Stanford Open Policing Project to compare search rates and search outcomes across three states: California, Texas, and Florida. I will look at whether search rates differ significantly across these states and whether contraband recovery rates also vary by location. Understanding these patterns is important because differences in police search practices can show us different enforcement priorities or potential biases in how searches are conducted. By examining the data from three different diverse states, I can find out whether patterns are consistent nationwide or vary by region.

## Connecting to the Database
```{r}
#| label: setup
library(DBI)
library(RMariaDB)
library(tidyverse)
library(ggplot2)

# Connect to traffic database
con_traffic <- DBI::dbConnect(
  RMariaDB::MariaDB(),
  dbname = "traffic",
  host = "traffic.st47s.com",
  user = Sys.getenv("TRAFFIC_USER"),
  password = Sys.getenv("TRAFFIC_PWD")
)
```

## Query 1: California Highway Patrol Search Rates

First, I will take a look at search patterns in California by calculating the overall search rate and the number of searches conducted by year.
```{sql connection=con_traffic}
SELECT 
  YEAR(date) AS stop_year,
  COUNT(*) AS total_stops,
  SUM(CASE WHEN search_conducted = TRUE THEN 1 ELSE 0 END) AS searches_conducted,
  ROUND(100.0 * SUM(CASE WHEN search_conducted = TRUE THEN 1 ELSE 0 END) / COUNT(*), 2) AS search_rate_percent
FROM ca_statewide_2023_01_26
WHERE YEAR(date) >= 2015 AND YEAR(date) <= 2019
GROUP BY stop_year
ORDER BY stop_year;
```

This query uses a few SQL keywords: WHERE to filter years 2015-2019, GROUP BY to seperate by year, COUNT and SUM for calculations, and ORDER BY to sort chronologically. The search rate shows what percentage of all traffic stops resulted in a search.

## Query 2: Texas Highway Patrol Search Rates

Next, I'll look at the same metrics for Texas to compare with California.
```{sql connection=con_traffic}
SELECT 
  YEAR(date) AS stop_year,
  COUNT(*) AS total_stops,
  SUM(CASE WHEN search_conducted = TRUE THEN 1 ELSE 0 END) AS searches_conducted,
  ROUND(100.0 * SUM(CASE WHEN search_conducted = TRUE THEN 1 ELSE 0 END) / COUNT(*), 2) AS search_rate_percent
FROM tx_statewide_2020_04_01
WHERE YEAR(date) >= 2015 AND YEAR(date) <= 2019
GROUP BY stop_year
ORDER BY stop_year;
```

## Query 3: Florida Highway Patrol Search Rates

Last, I will look at Florida's search patterns using the same approach.
```{sql connection=con_traffic}
SELECT 
  YEAR(date) AS stop_year,
  COUNT(*) AS total_stops,
  SUM(CASE WHEN search_conducted = TRUE THEN 1 ELSE 0 END) AS searches_conducted,
  ROUND(100.0 * SUM(CASE WHEN search_conducted = TRUE THEN 1 ELSE 0 END) / COUNT(*), 2) AS search_rate_percent
FROM fl_statewide_2020_04_01
WHERE YEAR(date) >= 2015 AND YEAR(date) <= 2019
GROUP BY stop_year
ORDER BY stop_year;
```

## Combined Analysis: Search Rates Across All Three States

Now I will combine data from all three states using "UNION" to create an all-inclusive comparison.
```{sql, connection=con_traffic, output.var="search_rates"}
SELECT 
  'California' AS state,
  YEAR(date) AS stop_year,
  COUNT(*) AS total_stops,
  SUM(CASE WHEN search_conducted = TRUE THEN 1 ELSE 0 END) AS searches_conducted,
  ROUND(100.0 * SUM(CASE WHEN search_conducted = TRUE THEN 1 ELSE 0 END) / COUNT(*), 2) AS search_rate_percent
FROM ca_statewide_2023_01_26
WHERE YEAR(date) BETWEEN 2015 AND 2019
GROUP BY stop_year

UNION ALL

SELECT 
  'Texas' AS state,
  YEAR(date) AS stop_year,
  COUNT(*) AS total_stops,
  SUM(CASE WHEN search_conducted = TRUE THEN 1 ELSE 0 END) AS searches_conducted,
  ROUND(100.0 * SUM(CASE WHEN search_conducted = TRUE THEN 1 ELSE 0 END) / COUNT(*), 2) AS search_rate_percent
FROM tx_statewide_2020_04_01
WHERE YEAR(date) BETWEEN 2015 AND 2019
GROUP BY stop_year

UNION ALL

SELECT 
  'Florida' AS state,
  YEAR(date) AS stop_year,
  COUNT(*) AS total_stops,
  SUM(CASE WHEN search_conducted = TRUE THEN 1 ELSE 0 END) AS searches_conducted,
  ROUND(100.0 * SUM(CASE WHEN search_conducted = TRUE THEN 1 ELSE 0 END) / COUNT(*), 2) AS search_rate_percent
FROM fl_statewide_2020_04_01
WHERE YEAR(date) BETWEEN 2015 AND 2019
GROUP BY stop_year

ORDER BY state, stop_year;
```

## Visualization: Search Rates Over Time
```{r}
#| label: search-rate-plot
ggplot(search_rates, aes(x = stop_year, y = search_rate_percent, color = state, group = state)) +
  geom_line(linewidth = 1.2) + 
  geom_point(size = 2.5) +
  labs(
    title = "Police Search Rates During Traffic Stops (2015-2019)",
    subtitle = "Comparison across California, Texas, and Florida",
    x = "Year",
    y = "Search Rate (%)",
    color = "State"
  ) +
  theme_minimal() +
  scale_color_manual(values = c("California" = "#1f77b4", "Texas" = "#ff7f0e", "Florida" = "#2ca02c"))
```

**What I See:** The line chart shows some clear differences in search rates across the three states over the five-year period that we were looking at. Texas consistently has the highest search rate, ranging from around 6-8% of all traffic stops resulting in searches. California has a more moderate search rate at around 3-5%, while Florida has the lowest search rates at roughly 2-3%. All three states show stable trends over time without dramatic increases or decreases. This suggests that search policies and practices differ substantially by state, with Texas officers conducting searches roughly twice as often as Florida officers during traffic stops.

## Contraband Recovery Analysis

To truly assess search effectiveness, I will examine "hit rates" - the percentage of searches that actually recover contraband. Higher hit rates show that searches are more targeted, while lower rates might  tell us that searches are conducted more broadly or with less concrete justification.
```{sql, connection=con_traffic, output.var="hit_rates"}
SELECT 
  'California' AS state,
  SUM(CASE WHEN search_conducted = TRUE THEN 1 ELSE 0 END) AS searches_conducted,
  SUM(CASE WHEN contraband_found = TRUE THEN 1 ELSE 0 END) AS contraband_found,
  ROUND(100.0 * SUM(CASE WHEN contraband_found = TRUE THEN 1 ELSE 0 END) / 
    SUM(CASE WHEN search_conducted = TRUE THEN 1 ELSE 0 END), 2) AS hit_rate_percent
FROM ca_statewide_2023_01_26
WHERE YEAR(date) BETWEEN 2015 AND 2019

UNION ALL

SELECT 
  'Texas' AS state,
  SUM(CASE WHEN search_conducted = TRUE THEN 1 ELSE 0 END) AS searches_conducted,
  SUM(CASE WHEN contraband_found = TRUE THEN 1 ELSE 0 END) AS contraband_found,
  ROUND(100.0 * SUM(CASE WHEN contraband_found = TRUE THEN 1 ELSE 0 END) / 
    SUM(CASE WHEN search_conducted = TRUE THEN 1 ELSE 0 END), 2) AS hit_rate_percent
FROM tx_statewide_2020_04_01
WHERE YEAR(date) BETWEEN 2015 AND 2019;
```

## Visualization: Contraband Recovery Rates
```{r}
#| label: hit-rate-plot
ggplot(hit_rates, aes(x = reorder(state, -hit_rate_percent), y = hit_rate_percent, fill = state)) +
  geom_col(width = 0.6) +
  geom_text(aes(label = paste0(hit_rate_percent, "%")), vjust = -0.5, size = 4) +
  labs(
    title = "Contraband Recovery Rates by State (2015-2019)",
    subtitle = "Percentage of searches that recovered contraband (Florida data unavailable)",
    x = "State",
    y = "Hit Rate (%)",
    fill = "State"
  ) +
  theme_minimal() +
  scale_fill_manual(values = c("California" = "#1f77b4", "Texas" = "#ff7f0e")) +
  theme(legend.position = "none")
```

**What I See:** The bar chart reveals a significant difference in search effectiveness between the two states. California has a hit rate of 3.51%, meaning contraband is found in around 3.5% of searches conducted. Texas has a notably higher hit rate of 41.65%, indicating that contraband is recovered in about 42% of searches. This is counterintuitive given that California conducts searches at a much higher rate (3.20% of stops) compared to Texas (1.05% of stops). The pattern shows that Texas may use different criteria before initiating searches, resulting in fewer but more productive searches.  Florida does not track contraband recovery in this dataset, limiting this research to California and Texas only.


## Summary Table
```{r}
#| label: summary-table
# Combine search rates and hit rates for summary
summary_data <- search_rates %>%
  group_by(state) %>%
  summarise(
    avg_search_rate = mean(search_rate_percent),
    total_stops = sum(total_stops)
  ) %>%
  left_join(hit_rates %>% select(state, hit_rate_percent), by = "state") %>%
  arrange(desc(avg_search_rate))

knitr::kable(summary_data, 
             digits = 2,
             col.names = c("State", "Avg Search Rate (%)", "Total Stops (2015-2019)", "Hit Rate (%)"),
             caption = "Summary Statistics: Search Patterns Across Three States (Florida hit rate unavailable)")
```

**What I See:** The summary table shows a few key findings from my analysis. California conducted searches in 3.20% of traffic stops on average, more than three times Texas's 1.05% and much higher than Florida's 0.20%. However, California's higher search rate does not really translate to better contraband recovery as its hit rate of 3.51% is actually lower than Texas's 41.65%. Florida's hit rate data is unavailable in this dataset. This pattern suggests different policing strategies across states: California appears to use a high-volume, lower-threshold approach to searches, while Texas is much more selective, resulting in far fewer searches but dramatically higher success rates in actually recovering contraband. The total stops column shows California has the highest amount of traffic stops overall (nearly 6 million), followed by Texas (5.8 million) and Florida (3.3 million).
```

## 5. UPDATE your Conclusion:
```
My SQL research looked at traffic stop and search patterns across California, Texas, and Florida using data from 2015-2019. I found significant differences in how often police preform searches during traffic stops, with California searching drivers at around three times the rate of Texas and sixteen times the rate of Florida. However, higher search rates did not correspond to higher contraband recovery rates. In fact, the relationship was inverse: Texas had the highest hit rate (41.65%) despite the second-lowest search rate, while California had a much lower hit rate (3.51%) with the highest search rate. Florida's contraband data was unavailable. These patterns show us that state-level policies and police department policies  impact both how often searches occur and how effective those searches are at recovering contraband.

## SQL Keywords Used

Throughout this analysis, I used the following SQL keywords (beyond SELECT, FROM, and LIMIT):

1. **WHERE** - Filtered data to specific year ranges and search conditions
2. **GROUP BY** - Seperated data by year and state
3. **COUNT** - Counted total stops and searches
4. **SUM** - Summed searches conducted and contraband found
5. **UNION ALL** - Combined results from three state tables
6. **ORDER BY** - Sorted results chronologically and by state
7. **CASE WHEN** - Created conditional logic for calculating search and contraband rates
8. **YEAR()** - Extracted year from date fields

## Data Source

**Citation:** Pierson, E., Simoiu, C., Overgoor, J., Corbett-Davies, S., Jenson, D., Shoemaker, A., Ramachandran, V., Shroff, R., & Goel, S. (2020). A large-scale analysis of racial disparities in police stops across the United States. *Nature Human Behaviour*, 4(7), 736-745. https://doi.org/10.1038/s41562-020-0858-1

**Data Source:** Stanford Open Policing Project. https://openpolicing.stanford.edu/
```{r}
#| label: disconnect
# Disconnect from database
dbDisconnect(con_traffic)
```