---
title: "Shakespeare Dialogue Analysis"
description: |
  Text analysis of Shakespeare plays using string functions and regular expressions
author: Eli Della Bitta
date: October 8, 2025
format: 
  html:
    warning: false
    message: false
    code-fold: true
---

This analysis will look at dialogue from Shakespeare's plays to find patterns in the text. I will use string functions and regular expressions to identify questions, exclamations, character speech patterns, and emotional language. The dataset contains lines from multiple Shakespeare plays including Romeo and Juliet, Hamlet, and Macbeth.

```{r}
#| label: setup
library(tidyverse)
library(stringr)

shakespeare <- read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/main/data/2024/2024-09-17/hamlet.csv')

head(shakespeare)
```

```{r}
#| label: question-analysis
shakespeare <- shakespeare |>
  mutate(
    is_question = str_detect(dialogue, "\\?$"),  
    is_exclamation = str_detect(dialogue, "!$"), 
    line_length = str_length(dialogue)            
  )

question_summary <- shakespeare |>
  summarise(
    questions = sum(is_question, na.rm = TRUE),
    exclamations = sum(is_exclamation, na.rm = TRUE),
    statements = n() - questions - exclamations
  ) |>
  pivot_longer(everything(), names_to = "type", values_to = "count")

ggplot(question_summary, aes(x = type, y = count, fill = type)) +
  geom_col() +
  labs(title = "Types of Lines in Hamlet",
       x = "Line Type",
       y = "Number of Lines") +
  theme_minimal() +
  scale_fill_manual(values = c("questions" = "lightblue", 
                                 "exclamations" = "pink",
                                 "statements" = "orange"))
```

Insight!: Most lines in Hamlet are statements, with very few questions and exclamations. This shows the play contains more direct dialogue than interrogative or emotional outbursts. Questions make up only a small portion of the total dialogue, showing that characters often speak in statements rather than inquiries.

```{r}
#| label: character-analysis
character_lines <- shakespeare |>
  group_by(character) |>
  summarise(
    total_lines = n(),
    avg_line_length = mean(line_length, na.rm = TRUE),
    question_rate = mean(is_question, na.rm = TRUE) * 100
  ) |>
  filter(total_lines >= 20) |>  
  arrange(desc(total_lines)) |>
  head(10)

ggplot(character_lines, aes(x = reorder(character, total_lines), y = total_lines)) +
  geom_col(fill = "skyblue") +
  coord_flip() +
  labs(title = "Top 10 Characters by Number of Lines in Hamlet",
       x = "Character",
       y = "Number of Lines") +
  theme_minimal()
```

Insight!: Hamlet has significantly more lines than any other character, which makes sense as the protagonist. The distribution shows a major drop off after the main character, with supporting characters like Horatio and Claudius having substantially fewer lines. This reflects the play's focus on Hamlet's internal struggles and thoughts.

```{r}
#| label: emotional-analysis
shakespeare <- shakespeare |>
  mutate(
    has_love = str_detect(dialogue, "(?i)\\blove\\b"),     
    has_death = str_detect(dialogue, "(?i)\\bdeath\\b"),   
    has_fear = str_detect(dialogue, "(?i)\\bfear\\b"),
    has_hate = str_detect(dialogue, "(?i)\\bhate\\b")
  )

emotion_counts <- shakespeare |>
  summarise(
    Love = sum(has_love, na.rm = TRUE),
    Death = sum(has_death, na.rm = TRUE),
    Fear = sum(has_fear, na.rm = TRUE),
    Hate = sum(has_hate, na.rm = TRUE)
  ) |>
  pivot_longer(everything(), names_to = "emotion", values_to = "count")

knitr::kable(emotion_counts, 
             caption = "Frequency of Emotional Words in Hamlet")
```

Insight!: The table shows how often different emotional themes appear in the dialogue. Death appears most frequently, which aligns with Hamlet's dark themes and tragic ending. Love appears less than death, reflecting the play's focus on mortality and revenge over romance. Fear and hate have some presence, contributing to the play's tense atmosphere.

```{r}
#| label: lookaround-analysis
thee_phrases <- shakespeare |>
  filter(str_detect(dialogue, "\\w+\\s+thee")) |>
  mutate(
    before_thee = str_extract(dialogue, "\\w+(?=\\s+thee)")
  ) |>
  filter(!is.na(before_thee)) |>
  count(before_thee, sort = TRUE) |>
  head(10)

knitr::kable(thee_phrases, 
             caption = "Most Common Words Before 'thee' in Hamlet",
             col.names = c("Word Before 'thee'", "Frequency"))
```

Insight!: This analysis shows common phrases used in Shakespearean English. Words like "with," "to," and "for" appear a lot before "thee," showing typical sentence structures of the time period. This pattern helps us understand how characters addressed each other in formal Early Modern English.

-   **TidyTuesday Dataset**: [Week 38, 2024 - Shakespeare Dialogue](https://github.com/rfordatascience/tidytuesday/blob/main/data/2024/2024-09-17/readme.md)
-   **Original Data Source**: shakespeare.mit.edu - The Complete Works of William Shakespeare, specifically the Hamlet text, made available by MIT
